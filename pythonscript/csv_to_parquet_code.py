import sys
from awsglue.transforms import *
from awsglue.utils import getResolvedOptions
from pyspark.context import SparkContext
from awsglue.context import GlueContext
from awsglue.job import Job

# @params: [JOB_NAME]
args = getResolvedOptions(sys.argv, ['JOB_NAME'])

sc = SparkContext()
glueContext = GlueContext(sc)
spark = glueContext.spark_session
job = Job(glueContext)
job.init(args['JOB_NAME'], args)
# @type: DataSource
# @args: [database = "gluedbtest", table_name = "csvfolder", transformation_ctx = "datasource0"]
# @return: datasource0
# @inputs: []
datasource0 = glueContext.create_dynamic_frame.from_catalog(
    database="mytestdb", table_name="csvfolder", transformation_ctx="datasource0")
# @type: ApplyMapping
# @args: [mapping = [("sofifa_id", "long", "sofifa_id", "long"), ("player_url", "string", "player_url", "string"), ("short_name", "string", "short_name", "string"), ("long_name", "string", "long_name", "string"), ("age", "long", "age", "long"), ("dob", "string", "dob", "string"), ("height_cm", "long", "height_cm", "long"), ("weight_kg", "long", "weight_kg", "long"), ("nationality", "string", "nationality", "string"), ("club", "string", "club", "string"), ("overall", "long", "overall", "long"), ("potential", "long", "potential", "long"), ("value_eur", "long", "value_eur", "long"), ("wage_eur", "long", "wage_eur", "long"), ("player_positions", "string", "player_positions", "string"), ("preferred_foot", "string", "preferred_foot", "string"), ("international_reputation", "long", "international_reputation", "long"), ("weak_foot", "long", "weak_foot", "long"), ("skill_moves", "long", "skill_moves", "long"), ("work_rate", "string", "work_rate", "string"), ("body_type", "string", "body_type", "string"), ("real_face", "string", "real_face", "string"), ("release_clause_eur", "long", "release_clause_eur", "long"), ("player_tags", "string", "player_tags", "string"), ("team_position", "string", "team_position", "string"), ("team_jersey_number", "long", "team_jersey_number", "long"), ("loaned_from", "string", "loaned_from", "string"), ("joined", "string", "joined", "string"), ("contract_valid_until", "long", "contract_valid_until", "long"), ("nation_position", "string", "nation_position", "string"), ("nation_jersey_number", "long", "nation_jersey_number", "long"), ("pace", "long", "pace", "long"), ("shooting", "long", "shooting", "long"), ("passing", "long", "passing", "long"), ("dribbling", "long", "dribbling", "long"), ("defending", "long", "defending", "long"), ("physic", "long", "physic", "long"), ("gk_diving", "long", "gk_diving", "long"), ("gk_handling", "long", "gk_handling", "long"), ("gk_kicking", "long", "gk_kicking", "long"), ("gk_reflexes", "long", "gk_reflexes", "long"), ("gk_speed", "long", "gk_speed", "long"), ("gk_positioning", "long", "gk_positioning", "long"), ("player_traits", "string", "player_traits", "string"), ("attacking_crossing", "string", "attacking_crossing", "string"), ("attacking_finishing", "string", "attacking_finishing", "string"), ("attacking_heading_accuracy", "string", "attacking_heading_accuracy", "string"), ("attacking_short_passing", "string", "attacking_short_passing", "string"), ("attacking_volleys", "string", "attacking_volleys", "string"), ("skill_dribbling", "string", "skill_dribbling", "string"), ("skill_curve", "string", "skill_curve", "string"), ("skill_fk_accuracy", "string", "skill_fk_accuracy", "string"), ("skill_long_passing", "string", "skill_long_passing", "string"), ("skill_ball_control", "string", "skill_ball_control", "string"), ("movement_acceleration", "string", "movement_acceleration", "string"), ("movement_sprint_speed", "string", "movement_sprint_speed", "string"), ("movement_agility", "string", "movement_agility", "string"), ("movement_reactions", "string", "movement_reactions", "string"), ("movement_balance", "string", "movement_balance", "string"), ("power_shot_power", "string", "power_shot_power", "string"), ("power_jumping", "string", "power_jumping", "string"), ("power_stamina", "string", "power_stamina", "string"), ("power_strength", "string", "power_strength", "string"), ("power_long_shots", "string", "power_long_shots", "string"), ("mentality_aggression", "string", "mentality_aggression", "string"), ("mentality_interceptions", "string", "mentality_interceptions", "string"), ("mentality_positioning", "string", "mentality_positioning", "string"), ("mentality_vision", "string", "mentality_vision", "string"), ("mentality_penalties", "string", "mentality_penalties", "string"), ("mentality_composure", "string", "mentality_composure", "string"), ("defending_marking", "string", "defending_marking", "string"), ("defending_standing_tackle", "string", "defending_standing_tackle", "string"), ("defending_sliding_tackle", "string", "defending_sliding_tackle", "string"), ("goalkeeping_diving", "string", "goalkeeping_diving", "string"), ("goalkeeping_handling", "string", "goalkeeping_handling", "string"), ("goalkeeping_kicking", "string", "goalkeeping_kicking", "string"), ("goalkeeping_positioning", "string", "goalkeeping_positioning", "string"), ("goalkeeping_reflexes", "string", "goalkeeping_reflexes", "string"), ("ls", "string", "ls", "string"), ("st", "string", "st", "string"), ("rs", "string", "rs", "string"), ("lw", "string", "lw", "string"), ("lf", "string", "lf", "string"), ("cf", "string", "cf", "string"), ("rf", "string", "rf", "string"), ("rw", "string", "rw", "string"), ("lam", "string", "lam", "string"), ("cam", "string", "cam", "string"), ("ram", "string", "ram", "string"), ("lm", "string", "lm", "string"), ("lcm", "string", "lcm", "string"), ("cm", "string", "cm", "string"), ("rcm", "string", "rcm", "string"), ("rm", "string", "rm", "string"), ("lwb", "string", "lwb", "string"), ("ldm", "string", "ldm", "string"), ("cdm", "string", "cdm", "string"), ("rdm", "string", "rdm", "string"), ("rwb", "string", "rwb", "string"), ("lb", "string", "lb", "string"), ("lcb", "string", "lcb", "string"), ("cb", "string", "cb", "string"), ("rcb", "string", "rcb", "string"), ("rb", "string", "rb", "string")], transformation_ctx = "applymapping1"]
# @return: applymapping1
# @inputs: [frame = datasource0]
applymapping1 = ApplyMapping.apply(frame=datasource0, mappings=[("sofifa_id", "long", "sofifa_id", "long"), ("player_url", "string", "player_url", "string"), ("short_name", "string", "short_name", "string"), ("long_name", "string", "long_name", "string"), ("age", "long", "age", "long"), ("dob", "string", "dob", "string"), ("height_cm", "long", "height_cm", "long"), ("weight_kg", "long", "weight_kg", "long"), ("nationality", "string", "nationality", "string"), ("club", "string", "club", "string"), ("overall", "long", "overall", "long"), ("potential", "long", "potential", "long"), ("value_eur", "long", "value_eur", "long"), ("wage_eur", "long", "wage_eur", "long"), ("player_positions", "string", "player_positions", "string"), ("preferred_foot", "string", "preferred_foot", "string"), ("international_reputation", "long", "international_reputation", "long"), ("weak_foot", "long", "weak_foot", "long"), ("skill_moves", "long", "skill_moves", "long"), ("work_rate", "string", "work_rate", "string"), ("body_type", "string", "body_type", "string"), ("real_face", "string", "real_face", "string"), ("release_clause_eur", "long", "release_clause_eur", "long"), ("player_tags", "string", "player_tags", "string"), ("team_position", "string", "team_position", "string"), ("team_jersey_number", "long", "team_jersey_number", "long"), ("loaned_from", "string", "loaned_from", "string"), ("joined", "string", "joined", "string"), ("contract_valid_until", "long", "contract_valid_until", "long"), ("nation_position", "string", "nation_position", "string"), ("nation_jersey_number", "long", "nation_jersey_number", "long"), ("pace", "long", "pace", "long"), ("shooting", "long", "shooting", "long"), ("passing", "long", "passing", "long"), ("dribbling", "long", "dribbling", "long"), ("defending", "long", "defending", "long"), ("physic", "long", "physic", "long"), ("gk_diving", "long", "gk_diving", "long"), ("gk_handling", "long", "gk_handling", "long"), ("gk_kicking", "long", "gk_kicking", "long"), ("gk_reflexes", "long", "gk_reflexes", "long"), ("gk_speed", "long", "gk_speed", "long"), ("gk_positioning", "long", "gk_positioning", "long"), ("player_traits", "string", "player_traits", "string"), ("attacking_crossing", "string", "attacking_crossing", "string"), ("attacking_finishing", "string", "attacking_finishing", "string"), ("attacking_heading_accuracy", "string", "attacking_heading_accuracy", "string"), ("attacking_short_passing", "string", "attacking_short_passing", "string"), ("attacking_volleys", "string", "attacking_volleys", "string"), ("skill_dribbling", "string", "skill_dribbling", "string"), ("skill_curve", "string", "skill_curve", "string"), ("skill_fk_accuracy", "string", "skill_fk_accuracy", "string"), (
    "skill_long_passing", "string", "skill_long_passing", "string"), ("skill_ball_control", "string", "skill_ball_control", "string"), ("movement_acceleration", "string", "movement_acceleration", "string"), ("movement_sprint_speed", "string", "movement_sprint_speed", "string"), ("movement_agility", "string", "movement_agility", "string"), ("movement_reactions", "string", "movement_reactions", "string"), ("movement_balance", "string", "movement_balance", "string"), ("power_shot_power", "string", "power_shot_power", "string"), ("power_jumping", "string", "power_jumping", "string"), ("power_stamina", "string", "power_stamina", "string"), ("power_strength", "string", "power_strength", "string"), ("power_long_shots", "string", "power_long_shots", "string"), ("mentality_aggression", "string", "mentality_aggression", "string"), ("mentality_interceptions", "string", "mentality_interceptions", "string"), ("mentality_positioning", "string", "mentality_positioning", "string"), ("mentality_vision", "string", "mentality_vision", "string"), ("mentality_penalties", "string", "mentality_penalties", "string"), ("mentality_composure", "string", "mentality_composure", "string"), ("defending_marking", "string", "defending_marking", "string"), ("defending_standing_tackle", "string", "defending_standing_tackle", "string"), ("defending_sliding_tackle", "string", "defending_sliding_tackle", "string"), ("goalkeeping_diving", "string", "goalkeeping_diving", "string"), ("goalkeeping_handling", "string", "goalkeeping_handling", "string"), ("goalkeeping_kicking", "string", "goalkeeping_kicking", "string"), ("goalkeeping_positioning", "string", "goalkeeping_positioning", "string"), ("goalkeeping_reflexes", "string", "goalkeeping_reflexes", "string"), ("ls", "string", "ls", "string"), ("st", "string", "st", "string"), ("rs", "string", "rs", "string"), ("lw", "string", "lw", "string"), ("lf", "string", "lf", "string"), ("cf", "string", "cf", "string"), ("rf", "string", "rf", "string"), ("rw", "string", "rw", "string"), ("lam", "string", "lam", "string"), ("cam", "string", "cam", "string"), ("ram", "string", "ram", "string"), ("lm", "string", "lm", "string"), ("lcm", "string", "lcm", "string"), ("cm", "string", "cm", "string"), ("rcm", "string", "rcm", "string"), ("rm", "string", "rm", "string"), ("lwb", "string", "lwb", "string"), ("ldm", "string", "ldm", "string"), ("cdm", "string", "cdm", "string"), ("rdm", "string", "rdm", "string"), ("rwb", "string", "rwb", "string"), ("lb", "string", "lb", "string"), ("lcb", "string", "lcb", "string"), ("cb", "string", "cb", "string"), ("rcb", "string", "rcb", "string"), ("rb", "string", "rb", "string")], transformation_ctx="applymapping1")
# @type: DataSink
# @args: [connection_type = "s3", connection_options = {"path": "s3://csv-to-parquet-glue-transform-bucket/output"}, format = "json", transformation_ctx = "datasink2"]
# @return: datasink2
# @inputs: [frame = applymapping1]
datasink2 = glueContext.write_dynamic_frame.from_options(frame=applymapping1, connection_type="s3", connection_options={
    "path": "s3://csv-to-parquet-glue-transforming-bucket/output"}, format="json", transformation_ctx="datasink2")
job.commit()
